<%- layout('layout/boilerplate') %>

<!-- Title, area, product, price, author, image, rating, thoughts, date -->
<section class="section">
  <div class="columns">
    <form
      action="/ramens/<%= ramen._id %>?_method=PATCH"
      class="form column is-6 is-offset-3 box"
      method="POST"
    >
      <h1 class="title">新增拉麵地圖</h1>
      <div class="field-group">
        <div class="field is-inline-block" style="width: 60%">
          <label class="label" for="title">店家名稱</label>
          <div class="control has-icons-left">
            <input
              type="text"
              placeholder="店家名稱"
              name="title"
              id="title"
              class="input"
              value="<%= ramen.title %>"
            />
            <span class="icon is-left">
              <i class="fas fa-utensils"></i>
            </span>
          </div>
        </div>
        <div class="field is-inline-block" style="width: 8.5%"></div>
        <div class="field is-inline-block" style="width: 30%">
          <label class="label" for="area">區域 / 鄰近地標</label>
          <div class="control has-icons-left">
            <input
              type="text"
              placeholder="拉麵店所在區域"
              name="area"
              id="area"
              class="input"
              value="<%= ramen.area %>"
            />
            <span class="icon is-left">
              <i class="mdi mdi-map"></i>
            </span>
          </div>
        </div>
      </div>

      <div class="field">
        <label class="label" for="product">拉麵名稱</label>
        <div class="control has-icons-left">
          <input
            type="text"
            placeholder="拉麵名稱"
            name="product"
            id="product"
            class="input"
            value="<%= ramen.product %>"
          />
          <span class="icon is-left">
            <i class="mdi mdi-noodles"></i>
          </span>
        </div>
      </div>

      <div class="field">
        <label class="label" for="price">價格</label>
        <div class="control has-icons-left">
          <input
            type="number"
            placeholder="價格"
            name="price"
            id="price"
            class="input"
            value="<%= ramen.price %>"
          />
          <span class="icon is-left">
            <i class="fas fa-dollar-sign"></i>
          </span>
        </div>
      </div>

      <div class="field">
        <label class="label" for="imageURL">圖片上傳</label>
        <div class="control has-icons-left">
          <input
            type="text"
            placeholder="圖片連結"
            name="imageURL"
            id="imageURL"
            class="input"
          />
          <span class="icon is-left">
            <i class="far fa-images"></i>
          </span>
        </div>
      </div>
      <!-- TODO: 顯示上傳照片 並新增刪除按鈕-->

      <div class="field column"></div>

      <div class="field">
        <label class="label" for="rating">口味評分</label>
        <dic class="control">
          <input
            class="form-range"
            type="range"
            name="rating"
            id="rating"
            min="1"
            max="10"
            step="0.1"
            style="width: 100%"
            value="<%= ramen.rating %>"
          />
          <!-- <output class="bubble" style="background: red;color: white;padding: 4px 12px;position: absolute;border-radius: 4px;left: 50%;transform: translateX(-50%);"></output> -->
          <p class="text my-2" id="showRatingValue"><%= ramen.rating %></p>
        </dic>
      </div>

      <div class="field">
        <label class="label" for="thoughts">食記心得</label>
        <div class="control">
          <textarea
            class="textarea"
            name="thoughts"
            id="thoughts"
            cols="30"
            rows="10"
          >
<%= ramen.thoughts %></textarea
          >
        </div>
      </div>

      <div class="field is-grouped is-grouped-centered">
        <p class="control">
          <button class="button is-danger">更新</button>
          <a href="/ramens/<%= ramen._id %> " class="button is-light">取消</a>
        </p>
      </div>
    </form>
  </div>
</section>

<script>
  let ratingValue = document.querySelector('#rating');
  // let bubble = document.querySelector('.bubble');
  ratingValue.addEventListener('input', () => {
    // setBubble(ratingValue, bubble);
    const ratingText = document.querySelector('#showRatingValue');
    ratingText.innerHTML = ratingValue.value;
  });

  // function setBubble(range, bubble) {
  //         const val = range.value;
  //         const min = range.min ? range.min : 0;
  //         const max = range.max ? range.max : 100;
  //         const newVal = Number(((val - min) * 100) / (max - min));
  //         bubble.innerHTML = val;

  //         // Sorta magic numbers based on size of the native UI thumb
  //         bubble.style.left = `calc(${newVal}% + (${8 - newVal * 0.15}px))`;
  //     }
</script>
